{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TimeWidgetTopFactory = TimeWidgetTopFactory;\nexports[\"default\"] = void 0;\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _styledComponents2 = require(\"../common/styled-components\");\nvar _icons = require(\"../common/icons\");\nvar _timeRangeSlider = _interopRequireDefault(require(\"../common/time-range-slider\"));\nvar _fieldSelector = _interopRequireDefault(require(\"../common/field-selector\"));\nvar _floatingTimeDisplay = _interopRequireDefault(require(\"../common/animation-control/floating-time-display\"));\nvar _timeRangeFilter = require(\"./time-range-filter\");\nvar _templateObject, _templateObject2, _templateObject3;\nvar TOP_SECTION_HEIGHT = '36px';\nvar TimeBottomWidgetInner = (0, _styledComponents[\"default\"])(_styledComponents2.BottomWidgetInner)(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  padding: 6px 32px 24px 32px;\\n\"])));\nvar TopSectionWrapper = _styledComponents[\"default\"].div.attrs({\n  className: 'time-widget--top'\n})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  justify-content: space-between;\\n  width: 100%;\\n  color: \", \";\\n  height: \", \";\\n\\n  .bottom-widget__y-axis {\\n    flex-grow: 1;\\n    margin-left: 20px;\\n  }\\n\\n  .bottom-widget__field-select {\\n    width: 160px;\\n    display: inline-block;\\n\\n    .item-selector__dropdown {\\n      background: transparent;\\n      padding: 4px 10px 4px 4px;\\n      border-color: transparent;\\n\\n      :active,\\n      :focus,\\n      &.focus,\\n      &.active {\\n        background: transparent;\\n        border-color: transparent;\\n      }\\n    }\\n\\n    .item-selector__dropdown:hover {\\n      background: transparent;\\n      border-color: transparent;\\n\\n      .item-selector__dropdown__value {\\n        color: \", \";\\n      }\\n    }\\n  }\\n\\n  .animation-control__speed-control {\\n    margin-right: -12px;\\n\\n    .animation-control__speed-slider {\\n      right: calc(0% - 48px);\\n    }\\n  }\\n\"])), function (props) {\n  return props.theme.labelColor;\n}, TOP_SECTION_HEIGHT, function (props) {\n  return props.hoverColor ? props.theme[props.hoverColor] : props.theme.textColorHl;\n});\nvar StyledTitle = (0, _styledComponents[\"default\"])(_styledComponents2.CenterFlexbox)(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  flex-grow: 0;\\n  color: \", \";\\n  margin-right: 10px;\\n\\n  .bottom-widget__icon {\\n    margin-right: 6px;\\n  }\\n  .bottom-widget__icon.speed {\\n    margin-right: 0;\\n  }\\n\"])), function (props) {\n  return props.theme.textColor;\n});\nTimeWidgetTopFactory.deps = [_fieldSelector[\"default\"]];\nfunction TimeWidgetTopFactory(FieldSelector) {\n  var TimeWidgetTop = function TimeWidgetTop(_ref) {\n    var filter = _ref.filter,\n      readOnly = _ref.readOnly,\n      datasets = _ref.datasets,\n      setFilterPlot = _ref.setFilterPlot,\n      index = _ref.index,\n      onClose = _ref.onClose;\n    var yAxisFields = (0, _react.useMemo)(function () {\n      return ((datasets[filter.dataId[0]] || {}).fields || []).filter(function (f) {\n        return f.type === 'integer' || f.type === 'real';\n      });\n    }, [datasets, filter.dataId]);\n    var _setFilterPlotYAxis = (0, _react.useCallback)(function (value) {\n      return setFilterPlot(index, {\n        yAxis: value\n      });\n    }, [setFilterPlot, index]);\n    return /*#__PURE__*/_react[\"default\"].createElement(TopSectionWrapper, null, /*#__PURE__*/_react[\"default\"].createElement(StyledTitle, {\n      className: \"bottom-widget__field\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.CenterFlexbox, {\n      className: \"bottom-widget__icon\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_icons.Clock, {\n      height: \"15px\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.SelectTextBold, null, filter.name)), /*#__PURE__*/_react[\"default\"].createElement(StyledTitle, {\n      className: \"bottom-widget__y-axis\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.CenterFlexbox, {\n      className: \"bottom-widget__icon\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_icons.LineChart, {\n      height: \"15px\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n      className: \"bottom-widget__field-select\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(FieldSelector, {\n      fields: yAxisFields,\n      placement: \"top\",\n      id: \"selected-time-widget-field\",\n      value: filter.yAxis ? filter.yAxis.name : null,\n      onSelect: _setFilterPlotYAxis,\n      placeholder: \"placeholder.yAxis\",\n      erasable: true,\n      showToken: false\n    }))), !readOnly ? /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.CenterFlexbox, null, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.IconRoundSmall, null, /*#__PURE__*/_react[\"default\"].createElement(_icons.Close, {\n      height: \"12px\",\n      onClick: onClose\n    }))) : null);\n  };\n  return TimeWidgetTop;\n}\nTimeWidgetFactory.deps = [_timeRangeSlider[\"default\"], _floatingTimeDisplay[\"default\"], TimeWidgetTopFactory];\nfunction TimeWidgetFactory(TimeRangeSlider, FloatingTimeDisplay, TimeWidgetTop) {\n  var TimeWidget = function TimeWidget(_ref2) {\n    var datasets = _ref2.datasets,\n      filter = _ref2.filter,\n      index = _ref2.index,\n      readOnly = _ref2.readOnly,\n      showTimeDisplay = _ref2.showTimeDisplay,\n      setFilterAnimationTime = _ref2.setFilterAnimationTime,\n      resetAnimation = _ref2.resetAnimation,\n      isAnimatable = _ref2.isAnimatable,\n      updateAnimationSpeed = _ref2.updateAnimationSpeed,\n      toggleAnimation = _ref2.toggleAnimation,\n      enlargeFilter = _ref2.enlargeFilter,\n      setFilterPlot = _ref2.setFilterPlot,\n      setFilterAnimationWindow = _ref2.setFilterAnimationWindow;\n    var _updateAnimationSpeed = (0, _react.useCallback)(function (speed) {\n      return updateAnimationSpeed(index, speed);\n    }, [updateAnimationSpeed, index]);\n    var _toggleAnimation = (0, _react.useCallback)(function () {\n      return toggleAnimation(index);\n    }, [toggleAnimation, index]);\n    var _onClose = (0, _react.useCallback)(function () {\n      return enlargeFilter(index);\n    }, [enlargeFilter, index]);\n    var _setFilterAnimationWindow = (0, _react.useCallback)(function (animationWindow) {\n      return setFilterAnimationWindow({\n        id: filter.id,\n        animationWindow: animationWindow\n      });\n    }, [setFilterAnimationWindow, filter.id]);\n    var timeSliderOnChange = (0, _react.useCallback)(function (value) {\n      return setFilterAnimationTime(index, 'value', value);\n    }, [setFilterAnimationTime, index]);\n    return /*#__PURE__*/_react[\"default\"].createElement(TimeBottomWidgetInner, {\n      className: \"bottom-widget--inner\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(TimeWidgetTop, {\n      filter: filter,\n      readOnly: readOnly,\n      datasets: datasets,\n      setFilterPlot: setFilterPlot,\n      index: index,\n      onClose: _onClose\n    }), /*#__PURE__*/_react[\"default\"].createElement(TimeRangeSlider, (0, _extends2[\"default\"])({}, (0, _timeRangeFilter.timeRangeSliderFieldsSelector)(filter), {\n      onChange: timeSliderOnChange,\n      toggleAnimation: _toggleAnimation,\n      updateAnimationSpeed: _updateAnimationSpeed,\n      setFilterAnimationWindow: _setFilterAnimationWindow,\n      hideTimeTitle: showTimeDisplay,\n      resetAnimation: resetAnimation,\n      isAnimatable: isAnimatable\n    })), showTimeDisplay ? /*#__PURE__*/_react[\"default\"].createElement(FloatingTimeDisplay, {\n      currentTime: filter.value,\n      defaultTimeFormat: filter.defaultTimeFormat,\n      timeFormat: filter.timeFormat,\n      timezone: filter.timezone\n    }) : null);\n  };\n  return /*#__PURE__*/_react[\"default\"].memo(TimeWidget);\n}\nvar _default = TimeWidgetFactory;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../src/components/filters/time-widget.js"],"names":["TOP_SECTION_HEIGHT","TimeBottomWidgetInner","BottomWidgetInner","TopSectionWrapper","div","attrs","className","props","theme","labelColor","hoverColor","textColorHl","StyledTitle","CenterFlexbox","textColor","TimeWidgetTopFactory","deps","FieldSelectorFactory","FieldSelector","TimeWidgetTop","filter","readOnly","datasets","setFilterPlot","index","onClose","yAxisFields","dataId","fields","f","type","_setFilterPlotYAxis","yAxis","value","name","TimeWidgetFactory","TimeRangeSliderFactory","FloatingTimeDisplayFactory","TimeRangeSlider","FloatingTimeDisplay","TimeWidget","showTimeDisplay","setFilterAnimationTime","resetAnimation","isAnimatable","updateAnimationSpeed","toggleAnimation","enlargeFilter","setFilterAnimationWindow","_updateAnimationSpeed","speed","_toggleAnimation","_onClose","_setFilterAnimationWindow","id","animationWindow","timeSliderOnChange","defaultTimeFormat","timeFormat","timezone","React","memo"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {useCallback, useMemo} from 'react';\nimport styled from 'styled-components';\nimport {\n  SelectTextBold,\n  IconRoundSmall,\n  CenterFlexbox,\n  BottomWidgetInner\n} from 'components/common/styled-components';\nimport {Close, Clock, LineChart} from 'components/common/icons';\nimport TimeRangeSliderFactory from 'components/common/time-range-slider';\nimport FieldSelectorFactory from 'components/common/field-selector';\nimport FloatingTimeDisplayFactory from 'components/common/animation-control/floating-time-display';\nimport {timeRangeSliderFieldsSelector} from './time-range-filter';\n\nconst TOP_SECTION_HEIGHT = '36px';\n\nconst TimeBottomWidgetInner = styled(BottomWidgetInner)`\n  padding: 6px 32px 24px 32px;\n`;\nconst TopSectionWrapper = styled.div.attrs({\n  className: 'time-widget--top'\n})`\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  color: ${props => props.theme.labelColor};\n  height: ${TOP_SECTION_HEIGHT};\n\n  .bottom-widget__y-axis {\n    flex-grow: 1;\n    margin-left: 20px;\n  }\n\n  .bottom-widget__field-select {\n    width: 160px;\n    display: inline-block;\n\n    .item-selector__dropdown {\n      background: transparent;\n      padding: 4px 10px 4px 4px;\n      border-color: transparent;\n\n      :active,\n      :focus,\n      &.focus,\n      &.active {\n        background: transparent;\n        border-color: transparent;\n      }\n    }\n\n    .item-selector__dropdown:hover {\n      background: transparent;\n      border-color: transparent;\n\n      .item-selector__dropdown__value {\n        color: ${props =>\n          props.hoverColor ? props.theme[props.hoverColor] : props.theme.textColorHl};\n      }\n    }\n  }\n\n  .animation-control__speed-control {\n    margin-right: -12px;\n\n    .animation-control__speed-slider {\n      right: calc(0% - 48px);\n    }\n  }\n`;\n\nconst StyledTitle = styled(CenterFlexbox)`\n  flex-grow: 0;\n  color: ${props => props.theme.textColor};\n  margin-right: 10px;\n\n  .bottom-widget__icon {\n    margin-right: 6px;\n  }\n  .bottom-widget__icon.speed {\n    margin-right: 0;\n  }\n`;\n\nTimeWidgetTopFactory.deps = [FieldSelectorFactory];\nexport function TimeWidgetTopFactory(FieldSelector) {\n  const TimeWidgetTop = ({filter, readOnly, datasets, setFilterPlot, index, onClose}) => {\n    const yAxisFields = useMemo(\n      () =>\n        ((datasets[filter.dataId[0]] || {}).fields || []).filter(\n          f => f.type === 'integer' || f.type === 'real'\n        ),\n      [datasets, filter.dataId]\n    );\n    const _setFilterPlotYAxis = useCallback(value => setFilterPlot(index, {yAxis: value}), [\n      setFilterPlot,\n      index\n    ]);\n    return (\n      <TopSectionWrapper>\n        <StyledTitle className=\"bottom-widget__field\">\n          <CenterFlexbox className=\"bottom-widget__icon\">\n            <Clock height=\"15px\" />\n          </CenterFlexbox>\n          <SelectTextBold>{filter.name}</SelectTextBold>\n        </StyledTitle>\n        <StyledTitle className=\"bottom-widget__y-axis\">\n          <CenterFlexbox className=\"bottom-widget__icon\">\n            <LineChart height=\"15px\" />\n          </CenterFlexbox>\n          <div className=\"bottom-widget__field-select\">\n            <FieldSelector\n              fields={yAxisFields}\n              placement=\"top\"\n              id=\"selected-time-widget-field\"\n              value={filter.yAxis ? filter.yAxis.name : null}\n              onSelect={_setFilterPlotYAxis}\n              placeholder=\"placeholder.yAxis\"\n              erasable\n              showToken={false}\n            />\n          </div>\n        </StyledTitle>\n        {!readOnly ? (\n          <CenterFlexbox>\n            <IconRoundSmall>\n              <Close height=\"12px\" onClick={onClose} />\n            </IconRoundSmall>\n          </CenterFlexbox>\n        ) : null}\n      </TopSectionWrapper>\n    );\n  };\n  return TimeWidgetTop;\n}\n\nTimeWidgetFactory.deps = [TimeRangeSliderFactory, FloatingTimeDisplayFactory, TimeWidgetTopFactory];\nfunction TimeWidgetFactory(TimeRangeSlider, FloatingTimeDisplay, TimeWidgetTop) {\n  const TimeWidget = ({\n    datasets,\n    filter,\n    index,\n    readOnly,\n    showTimeDisplay,\n    setFilterAnimationTime,\n    resetAnimation,\n    isAnimatable,\n    updateAnimationSpeed,\n    toggleAnimation,\n    enlargeFilter,\n    setFilterPlot,\n    setFilterAnimationWindow\n  }) => {\n    const _updateAnimationSpeed = useCallback(speed => updateAnimationSpeed(index, speed), [\n      updateAnimationSpeed,\n      index\n    ]);\n\n    const _toggleAnimation = useCallback(() => toggleAnimation(index), [toggleAnimation, index]);\n\n    const _onClose = useCallback(() => enlargeFilter(index), [enlargeFilter, index]);\n\n    const _setFilterAnimationWindow = useCallback(\n      animationWindow => setFilterAnimationWindow({id: filter.id, animationWindow}),\n      [setFilterAnimationWindow, filter.id]\n    );\n\n    const timeSliderOnChange = useCallback(value => setFilterAnimationTime(index, 'value', value), [\n      setFilterAnimationTime,\n      index\n    ]);\n\n    return (\n      <TimeBottomWidgetInner className=\"bottom-widget--inner\">\n        <TimeWidgetTop\n          filter={filter}\n          readOnly={readOnly}\n          datasets={datasets}\n          setFilterPlot={setFilterPlot}\n          index={index}\n          onClose={_onClose}\n        />\n        <TimeRangeSlider\n          {...timeRangeSliderFieldsSelector(filter)}\n          onChange={timeSliderOnChange}\n          toggleAnimation={_toggleAnimation}\n          updateAnimationSpeed={_updateAnimationSpeed}\n          setFilterAnimationWindow={_setFilterAnimationWindow}\n          hideTimeTitle={showTimeDisplay}\n          resetAnimation={resetAnimation}\n          isAnimatable={isAnimatable}\n        />\n        {showTimeDisplay ? (\n          <FloatingTimeDisplay\n            currentTime={filter.value}\n            defaultTimeFormat={filter.defaultTimeFormat}\n            timeFormat={filter.timeFormat}\n            timezone={filter.timezone}\n          />\n        ) : null}\n      </TimeBottomWidgetInner>\n    );\n  };\n\n  return React.memo(TimeWidget);\n}\n\nexport default TimeWidgetFactory;\n"]},"metadata":{},"sourceType":"script"}