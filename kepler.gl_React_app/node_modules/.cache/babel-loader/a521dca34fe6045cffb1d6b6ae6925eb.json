{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.DatasetTabs = exports.DatasetModalTab = void 0;\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireDefault(require(\"react\"));\nvar _styledComponents = _interopRequireWildcard(require(\"styled-components\"));\nvar _datasetLabel = _interopRequireDefault(require(\"../common/dataset-label\"));\nvar _dataTable = _interopRequireDefault(require(\"../common/data-table\"));\nvar _reselect = require(\"reselect\");\nvar _cellSize = require(\"../common/data-table/cell-size\");\nvar _canvas = _interopRequireDefault(require(\"../common/data-table/canvas\"));\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2[\"default\"])(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return (0, _possibleConstructorReturn2[\"default\"])(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nvar dgSettings = {\n  sidePadding: '38px',\n  verticalPadding: '16px',\n  height: '36px'\n};\nvar StyledModal = _styledComponents[\"default\"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  min-height: 70vh;\\n  overflow: hidden;\\n  display: flex;\\n\"])));\nvar DatasetCatalog = _styledComponents[\"default\"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  padding: \", \" \", \" 0;\\n\"])), dgSettings.verticalPadding, dgSettings.sidePadding);\nvar DatasetModalTab = _styledComponents[\"default\"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  align-items: center;\\n  border-bottom: 3px solid \", \";\\n  cursor: pointer;\\n  display: flex;\\n  height: 35px;\\n  margin: 0 3px;\\n  padding: 0 5px;\\n\\n  :first-child {\\n    margin-left: 0;\\n    padding-left: 0;\\n  }\\n\"])), function (props) {\n  return props.active ? 'black' : 'transparent';\n});\nexports.DatasetModalTab = DatasetModalTab;\nvar DatasetTabsUnmemoized = function DatasetTabsUnmemoized(_ref) {\n  var activeDataset = _ref.activeDataset,\n    datasets = _ref.datasets,\n    showDatasetTable = _ref.showDatasetTable;\n  return /*#__PURE__*/_react[\"default\"].createElement(DatasetCatalog, {\n    className: \"dataset-modal-catalog\"\n  }, Object.values(datasets).map(function (dataset) {\n    return /*#__PURE__*/_react[\"default\"].createElement(DatasetModalTab, {\n      className: \"dataset-modal-tab\",\n      active: dataset === activeDataset,\n      key: dataset.id,\n      onClick: function onClick() {\n        return showDatasetTable(dataset.id);\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_datasetLabel[\"default\"], {\n      dataset: dataset\n    }));\n  }));\n};\nvar DatasetTabs = /*#__PURE__*/_react[\"default\"].memo(DatasetTabsUnmemoized);\nexports.DatasetTabs = DatasetTabs;\nDatasetTabs.displayName = 'DatasetTabs';\nDataTableModalFactory.deps = [_dataTable[\"default\"]];\nvar TableContainer = _styledComponents[\"default\"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  flex-direction: column;\\n  flex-grow: 1;\\n  min-height: 100%;\\n  max-height: 100%;\\n\"])));\nfunction DataTableModalFactory(DataTable) {\n  var DataTableModal = /*#__PURE__*/function (_React$Component) {\n    (0, _inherits2[\"default\"])(DataTableModal, _React$Component);\n    var _super = _createSuper(DataTableModal);\n    function DataTableModal() {\n      var _this;\n      (0, _classCallCheck2[\"default\"])(this, DataTableModal);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _super.call.apply(_super, [this].concat(args));\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"datasetCellSizeCache\", {});\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"dataId\", function (props) {\n        return props.dataId;\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"datasets\", function (props) {\n        return props.datasets;\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"fields\", function (props) {\n        return (props.datasets[props.dataId] || {}).fields;\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"columns\", (0, _reselect.createSelector)(_this.fields, function (fields) {\n        return fields.map(function (f) {\n          return f.name;\n        });\n      }));\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"colMeta\", (0, _reselect.createSelector)(_this.fields, function (fields) {\n        return fields.reduce(function (acc, _ref2) {\n          var name = _ref2.name,\n            displayName = _ref2.displayName,\n            type = _ref2.type;\n          return _objectSpread(_objectSpread({}, acc), {}, (0, _defineProperty2[\"default\"])({}, name, {\n            name: displayName || name,\n            type: type\n          }));\n        }, {});\n      }));\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"cellSizeCache\", (0, _reselect.createSelector)(_this.dataId, _this.datasets, function (dataId, datasets) {\n        if (!datasets[dataId]) {\n          return {};\n        }\n        var _datasets$dataId = datasets[dataId],\n          fields = _datasets$dataId.fields,\n          dataContainer = _datasets$dataId.dataContainer;\n        var showCalculate = null;\n        if (!_this.datasetCellSizeCache[dataId]) {\n          showCalculate = true;\n        } else if (_this.datasetCellSizeCache[dataId].fields !== fields || _this.datasetCellSizeCache[dataId].dataContainer !== dataContainer) {\n          showCalculate = true;\n        }\n        if (!showCalculate) {\n          return _this.datasetCellSizeCache[dataId].cellSizeCache;\n        }\n        var cellSizeCache = fields.reduce(function (acc, field, colIdx) {\n          return _objectSpread(_objectSpread({}, acc), {}, (0, _defineProperty2[\"default\"])({}, field.name, (0, _cellSize.renderedSize)({\n            text: {\n              dataContainer: dataContainer,\n              column: field.name\n            },\n            colIdx: colIdx,\n            type: field.type,\n            fontSize: _this.props.theme.cellFontSize,\n            font: _this.props.theme.fontFamily\n          })));\n        }, {}); // save it to cache\n\n        _this.datasetCellSizeCache[dataId] = {\n          cellSizeCache: cellSizeCache,\n          fields: fields,\n          dataContainer: dataContainer\n        };\n        return cellSizeCache;\n      }));\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"copyTableColumn\", function (column) {\n        var _this$props = _this.props,\n          dataId = _this$props.dataId,\n          copyTableColumn = _this$props.copyTableColumn;\n        copyTableColumn(dataId, column);\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"pinTableColumn\", function (column) {\n        var _this$props2 = _this.props,\n          dataId = _this$props2.dataId,\n          pinTableColumn = _this$props2.pinTableColumn;\n        pinTableColumn(dataId, column);\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"sortTableColumn\", function (column, mode) {\n        var _this$props3 = _this.props,\n          dataId = _this$props3.dataId,\n          sortTableColumn = _this$props3.sortTableColumn;\n        sortTableColumn(dataId, column, mode);\n      });\n      return _this;\n    }\n    (0, _createClass2[\"default\"])(DataTableModal, [{\n      key: \"render\",\n      value: function render() {\n        var _this$props4 = this.props,\n          datasets = _this$props4.datasets,\n          dataId = _this$props4.dataId,\n          showDatasetTable = _this$props4.showDatasetTable,\n          showTab = _this$props4.showTab;\n        if (!datasets || !dataId) {\n          return null;\n        }\n        var activeDataset = datasets[dataId];\n        var columns = this.columns(this.props);\n        var colMeta = this.colMeta(this.props);\n        var cellSizeCache = this.cellSizeCache(this.props);\n        return /*#__PURE__*/_react[\"default\"].createElement(StyledModal, {\n          className: \"dataset-modal\",\n          id: \"dataset-modal\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_canvas[\"default\"], null), /*#__PURE__*/_react[\"default\"].createElement(TableContainer, null, showTab ? /*#__PURE__*/_react[\"default\"].createElement(DatasetTabs, {\n          activeDataset: activeDataset,\n          datasets: datasets,\n          showDatasetTable: showDatasetTable\n        }) : null, datasets[dataId] ? /*#__PURE__*/_react[\"default\"].createElement(DataTable, {\n          key: dataId,\n          columns: columns,\n          colMeta: colMeta,\n          cellSizeCache: cellSizeCache,\n          dataContainer: activeDataset.dataContainer,\n          pinnedColumns: activeDataset.pinnedColumns,\n          sortOrder: activeDataset.sortOrder,\n          sortColumn: activeDataset.sortColumn,\n          copyTableColumn: this.copyTableColumn,\n          pinTableColumn: this.pinTableColumn,\n          sortTableColumn: this.sortTableColumn\n        }) : null));\n      }\n    }]);\n    return DataTableModal;\n  }(_react[\"default\"].Component);\n  DataTableModal.defaultProps = {\n    showTab: true\n  };\n  return (0, _styledComponents.withTheme)(DataTableModal);\n}\nvar _default = DataTableModalFactory;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../src/components/modals/data-table-modal.js"],"names":["dgSettings","sidePadding","verticalPadding","height","StyledModal","styled","div","DatasetCatalog","DatasetModalTab","props","active","DatasetTabsUnmemoized","activeDataset","datasets","showDatasetTable","values","map","dataset","id","DatasetTabs","React","memo","displayName","DataTableModalFactory","deps","DataTableFactory","TableContainer","DataTable","DataTableModal","Component","dataId","fields","f","name","reduce","acc","type","dataContainer","showCalculate","datasetCellSizeCache","cellSizeCache","field","colIdx","text","column","fontSize","theme","cellFontSize","font","fontFamily","copyTableColumn","pinTableColumn","mode","sortTableColumn","showTab","columns","colMeta","pinnedColumns","sortOrder","sortColumn","defaultProps"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React from 'react';\nimport styled, {withTheme} from 'styled-components';\nimport DatasetLabel from 'components/common/dataset-label';\nimport DataTableFactory from 'components/common/data-table';\nimport {createSelector} from 'reselect';\nimport {renderedSize} from 'components/common/data-table/cell-size';\nimport CanvasHack from 'components/common/data-table/canvas';\n\nconst dgSettings = {\n  sidePadding: '38px',\n  verticalPadding: '16px',\n  height: '36px'\n};\n\nconst StyledModal = styled.div`\n  min-height: 70vh;\n  overflow: hidden;\n  display: flex;\n`;\n\nconst DatasetCatalog = styled.div`\n  display: flex;\n  padding: ${dgSettings.verticalPadding} ${dgSettings.sidePadding} 0;\n`;\n\nexport const DatasetModalTab = styled.div`\n  align-items: center;\n  border-bottom: 3px solid ${props => (props.active ? 'black' : 'transparent')};\n  cursor: pointer;\n  display: flex;\n  height: 35px;\n  margin: 0 3px;\n  padding: 0 5px;\n\n  :first-child {\n    margin-left: 0;\n    padding-left: 0;\n  }\n`;\n\nconst DatasetTabsUnmemoized = ({activeDataset, datasets, showDatasetTable}) => (\n  <DatasetCatalog className=\"dataset-modal-catalog\">\n    {Object.values(datasets).map(dataset => (\n      <DatasetModalTab\n        className=\"dataset-modal-tab\"\n        active={dataset === activeDataset}\n        key={dataset.id}\n        onClick={() => showDatasetTable(dataset.id)}\n      >\n        <DatasetLabel dataset={dataset} />\n      </DatasetModalTab>\n    ))}\n  </DatasetCatalog>\n);\n\nexport const DatasetTabs = React.memo(DatasetTabsUnmemoized);\n\nDatasetTabs.displayName = 'DatasetTabs';\n\nDataTableModalFactory.deps = [DataTableFactory];\n\nconst TableContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  min-height: 100%;\n  max-height: 100%;\n`;\n\nfunction DataTableModalFactory(DataTable) {\n  class DataTableModal extends React.Component {\n    datasetCellSizeCache = {};\n    dataId = props => props.dataId;\n    datasets = props => props.datasets;\n    fields = props => (props.datasets[props.dataId] || {}).fields;\n    columns = createSelector(this.fields, fields => fields.map(f => f.name));\n    colMeta = createSelector(this.fields, fields =>\n      fields.reduce(\n        (acc, {name, displayName, type}) => ({\n          ...acc,\n          [name]: {\n            name: displayName || name,\n            type\n          }\n        }),\n        {}\n      )\n    );\n\n    cellSizeCache = createSelector(this.dataId, this.datasets, (dataId, datasets) => {\n      if (!datasets[dataId]) {\n        return {};\n      }\n      const {fields, dataContainer} = datasets[dataId];\n\n      let showCalculate = null;\n      if (!this.datasetCellSizeCache[dataId]) {\n        showCalculate = true;\n      } else if (\n        this.datasetCellSizeCache[dataId].fields !== fields ||\n        this.datasetCellSizeCache[dataId].dataContainer !== dataContainer\n      ) {\n        showCalculate = true;\n      }\n\n      if (!showCalculate) {\n        return this.datasetCellSizeCache[dataId].cellSizeCache;\n      }\n\n      const cellSizeCache = fields.reduce(\n        (acc, field, colIdx) => ({\n          ...acc,\n          [field.name]: renderedSize({\n            text: {\n              dataContainer,\n              column: field.name\n            },\n            colIdx,\n            type: field.type,\n            fontSize: this.props.theme.cellFontSize,\n            font: this.props.theme.fontFamily\n          })\n        }),\n        {}\n      );\n      // save it to cache\n      this.datasetCellSizeCache[dataId] = {\n        cellSizeCache,\n        fields,\n        dataContainer\n      };\n      return cellSizeCache;\n    });\n\n    copyTableColumn = column => {\n      const {dataId, copyTableColumn} = this.props;\n      copyTableColumn(dataId, column);\n    };\n\n    pinTableColumn = column => {\n      const {dataId, pinTableColumn} = this.props;\n      pinTableColumn(dataId, column);\n    };\n\n    sortTableColumn = (column, mode) => {\n      const {dataId, sortTableColumn} = this.props;\n      sortTableColumn(dataId, column, mode);\n    };\n\n    render() {\n      const {datasets, dataId, showDatasetTable, showTab} = this.props;\n      if (!datasets || !dataId) {\n        return null;\n      }\n      const activeDataset = datasets[dataId];\n      const columns = this.columns(this.props);\n      const colMeta = this.colMeta(this.props);\n      const cellSizeCache = this.cellSizeCache(this.props);\n\n      return (\n        <StyledModal className=\"dataset-modal\" id=\"dataset-modal\">\n          <CanvasHack />\n          <TableContainer>\n            {showTab ? (\n              <DatasetTabs\n                activeDataset={activeDataset}\n                datasets={datasets}\n                showDatasetTable={showDatasetTable}\n              />\n            ) : null}\n            {datasets[dataId] ? (\n              <DataTable\n                key={dataId}\n                columns={columns}\n                colMeta={colMeta}\n                cellSizeCache={cellSizeCache}\n                dataContainer={activeDataset.dataContainer}\n                pinnedColumns={activeDataset.pinnedColumns}\n                sortOrder={activeDataset.sortOrder}\n                sortColumn={activeDataset.sortColumn}\n                copyTableColumn={this.copyTableColumn}\n                pinTableColumn={this.pinTableColumn}\n                sortTableColumn={this.sortTableColumn}\n              />\n            ) : null}\n          </TableContainer>\n        </StyledModal>\n      );\n    }\n  }\n  DataTableModal.defaultProps = {\n    showTab: true\n  };\n  return withTheme(DataTableModal);\n}\n\nexport default DataTableModalFactory;\n"]},"metadata":{},"sourceType":"script"}