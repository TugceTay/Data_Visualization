{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _d3Scale = require(\"d3-scale\");\nvar _d3Array = require(\"d3-array\");\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _templateObject;\nvar histogramStyle = {\n  highlightW: 0.7,\n  unHighlightedW: 0.4\n};\nvar HistogramWrapper = _styledComponents[\"default\"].svg(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  overflow: visible;\\n  .histogram-bars {\\n    rect {\\n      fill: \", \";\\n    }\\n    rect.in-range {\\n      fill: \", \";\\n    }\\n  }\\n\"])), function (props) {\n  return props.theme.histogramFillOutRange;\n}, function (props) {\n  return props.theme.histogramFillInRange;\n});\nfunction HistogramPlotFactory() {\n  var HistogramPlot = function HistogramPlot(_ref) {\n    var width = _ref.width,\n      height = _ref.height,\n      margin = _ref.margin,\n      isRanged = _ref.isRanged,\n      histogram = _ref.histogram,\n      value = _ref.value,\n      brushComponent = _ref.brushComponent;\n    var domain = (0, _react.useMemo)(function () {\n      return [histogram[0].x0, histogram[histogram.length - 1].x1];\n    }, [histogram]);\n    var dataId = Object.keys(histogram[0]).filter(function (k) {\n      return k !== 'x0' && k !== 'x1';\n    })[0]; // use 1st for now\n\n    var getValue = (0, _react.useMemo)(function () {\n      return function (d) {\n        return d[dataId];\n      };\n    }, [dataId]);\n    var x = (0, _react.useMemo)(function () {\n      return (0, _d3Scale.scaleLinear)().domain(domain).range([0, width]);\n    }, [domain, width]);\n    var y = (0, _react.useMemo)(function () {\n      return (0, _d3Scale.scaleLinear)().domain([0, Number((0, _d3Array.max)(histogram, getValue))]).range([0, height]);\n    }, [histogram, height, getValue]);\n    var barWidth = width / histogram.length;\n    return /*#__PURE__*/_react[\"default\"].createElement(HistogramWrapper, {\n      width: width,\n      height: height,\n      style: {\n        marginTop: \"\".concat(margin.top, \"px\")\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(\"g\", {\n      className: \"histogram-bars\"\n    }, histogram.map(function (bar) {\n      var inRange = bar.x1 <= value[1] && bar.x0 >= value[0];\n      var wRatio = inRange ? histogramStyle.highlightW : histogramStyle.unHighlightedW;\n      return /*#__PURE__*/_react[\"default\"].createElement(\"rect\", {\n        className: (0, _classnames[\"default\"])({\n          'in-range': inRange\n        }),\n        key: bar.x0,\n        height: y(getValue(bar)),\n        width: barWidth * wRatio,\n        x: x(bar.x0) + barWidth * (1 - wRatio) / 2,\n        rx: 1,\n        ry: 1,\n        y: height - y(getValue(bar))\n      });\n    })), /*#__PURE__*/_react[\"default\"].createElement(\"g\", {\n      transform: \"translate(\".concat(isRanged ? 0 : barWidth / 2, \", 0)\")\n    }, brushComponent));\n  };\n  var EmpptyOrPlot = function EmpptyOrPlot(props) {\n    return !props.histogram || !props.histogram.length ? null : /*#__PURE__*/_react[\"default\"].createElement(HistogramPlot, props);\n  };\n  return EmpptyOrPlot;\n}\nvar _default = HistogramPlotFactory;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../src/components/common/histogram-plot.js"],"names":["histogramStyle","highlightW","unHighlightedW","HistogramWrapper","styled","svg","props","theme","histogramFillOutRange","histogramFillInRange","HistogramPlotFactory","HistogramPlot","width","height","margin","isRanged","histogram","value","brushComponent","domain","x0","length","x1","dataId","keys","filter","k","getValue","d","x","range","y","Number","barWidth","marginTop","top","map","inRange","bar","wRatio","EmpptyOrPlot"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {useMemo} from 'react';\nimport {scaleLinear} from 'd3-scale';\nimport {max} from 'd3-array';\nimport styled from 'styled-components';\nimport classnames from 'classnames';\n\nconst histogramStyle = {\n  highlightW: 0.7,\n  unHighlightedW: 0.4\n};\n\nconst HistogramWrapper = styled.svg`\n  overflow: visible;\n  .histogram-bars {\n    rect {\n      fill: ${props => props.theme.histogramFillOutRange};\n    }\n    rect.in-range {\n      fill: ${props => props.theme.histogramFillInRange};\n    }\n  }\n`;\n\nfunction HistogramPlotFactory() {\n  const HistogramPlot = ({width, height, margin, isRanged, histogram, value, brushComponent}) => {\n    const domain = useMemo(() => [histogram[0].x0, histogram[histogram.length - 1].x1], [\n      histogram\n    ]);\n    const dataId = Object.keys(histogram[0]).filter(k => k !== 'x0' && k !== 'x1')[0];\n\n    // use 1st for now\n    const getValue = useMemo(() => d => d[dataId], [dataId]);\n\n    const x = useMemo(\n      () =>\n        scaleLinear()\n          .domain(domain)\n          .range([0, width]),\n      [domain, width]\n    );\n\n    const y = useMemo(\n      () =>\n        scaleLinear()\n          .domain([0, Number(max(histogram, getValue))])\n          .range([0, height]),\n      [histogram, height, getValue]\n    );\n\n    const barWidth = width / histogram.length;\n\n    return (\n      <HistogramWrapper width={width} height={height} style={{marginTop: `${margin.top}px`}}>\n        <g className=\"histogram-bars\">\n          {histogram.map(bar => {\n            const inRange = bar.x1 <= value[1] && bar.x0 >= value[0];\n            const wRatio = inRange ? histogramStyle.highlightW : histogramStyle.unHighlightedW;\n            return (\n              <rect\n                className={classnames({'in-range': inRange})}\n                key={bar.x0}\n                height={y(getValue(bar))}\n                width={barWidth * wRatio}\n                x={x(bar.x0) + (barWidth * (1 - wRatio)) / 2}\n                rx={1}\n                ry={1}\n                y={height - y(getValue(bar))}\n              />\n            );\n          })}\n        </g>\n        <g transform={`translate(${isRanged ? 0 : barWidth / 2}, 0)`}>{brushComponent}</g>\n      </HistogramWrapper>\n    );\n  };\n\n  const EmpptyOrPlot = props =>\n    !props.histogram || !props.histogram.length ? null : <HistogramPlot {...props} />;\n\n  return EmpptyOrPlot;\n}\nexport default HistogramPlotFactory;\n"]},"metadata":{},"sourceType":"script"}