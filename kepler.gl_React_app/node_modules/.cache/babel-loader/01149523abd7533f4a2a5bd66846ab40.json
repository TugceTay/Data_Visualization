{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\nvar _fuzzy = _interopRequireDefault(require(\"fuzzy\"));\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _window = require(\"global/window\");\nvar _accessor = _interopRequireDefault(require(\"./accessor\"));\nvar _dropdownList = _interopRequireWildcard(require(\"./dropdown-list\"));\nvar _icons = require(\"../icons\");\nvar _keyevent = _interopRequireDefault(require(\"../../../constants/keyevent\"));\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2[\"default\"])(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return (0, _possibleConstructorReturn2[\"default\"])(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nvar DEFAULT_CLASS = 'typeahead';\n/**\n * Copied mostly from 'react-typeahead', an auto-completing text input\n *\n * Renders an text input that shows options nearby that you can use the\n * keyboard or mouse to select.\n */\n\nvar TypeaheadWrapper = _styledComponents[\"default\"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  flex-direction: column;\\n  background-color: \", \";\\n  box-shadow: \", \";\\n\\n  :focus {\\n    outline: 0;\\n  }\\n\"])), function (props) {\n  return props.light ? props.theme.dropdownListBgdLT : props.theme.dropdownListBgd;\n}, function (props) {\n  return props.theme.dropdownListShadow;\n});\nvar InputBox = _styledComponents[\"default\"].div.attrs({\n  className: 'typeahead__input_box'\n})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  padding: 8px;\\n\"])));\nvar TypeaheadInput = _styledComponents[\"default\"].input(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  \", \" :hover {\\n    cursor: pointer;\\n    background-color: \", \";\\n  }\\n\"])), function (props) {\n  return props.light ? props.theme.inputLT : props.theme.secondaryInput;\n}, function (props) {\n  return props.light ? props.theme.selectBackgroundLT : props.theme.secondaryInputBgd;\n});\nvar InputIcon = _styledComponents[\"default\"].div.attrs({\n  className: 'typeahead__input_icon'\n})(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  position: absolute;\\n  right: 15px;\\n  top: 14px;\\n  color: \", \";\\n\"])), function (props) {\n  return props.theme.inputPlaceholderColor;\n});\nfunction generateSearchFunction(props) {\n  var searchOptions = props.searchOptions,\n    filterOption = props.filterOption;\n  if (typeof searchOptions === 'function') {\n    if (filterOption !== null) {\n      _window.console.warn('searchOptions prop is being used, filterOption prop will be ignored');\n    }\n    return searchOptions;\n  } else if (typeof filterOption === 'function') {\n    // use custom filter option\n    return function (value, options) {\n      return options.filter(function (o) {\n        return filterOption(value, o);\n      });\n    };\n  }\n  var mapper = typeof filterOption === 'string' ? _accessor[\"default\"].generateAccessor(filterOption) : _accessor[\"default\"].IDENTITY_FN;\n  return function (value, options) {\n    return _fuzzy[\"default\"].filter(value, options, {\n      extract: mapper\n    }).map(function (res) {\n      return options[res.index];\n    });\n  };\n}\nfunction getOptionsForValue(value, props, state) {\n  var options = props.options,\n    showOptionsWhenEmpty = props.showOptionsWhenEmpty;\n  if (!props.searchable) {\n    // directly pass through options if can not be searched\n    return options;\n  }\n  if (shouldSkipSearch(value, state, showOptionsWhenEmpty)) {\n    return options;\n  }\n  var searchOptions = generateSearchFunction(props);\n  return searchOptions(value, options);\n}\nfunction shouldSkipSearch(input, state, showOptionsWhenEmpty) {\n  var emptyValue = !input || input.trim().length === 0; // this.state must be checked because it may not be defined yet if this function\n  // is called from within getInitialState\n\n  var isFocused = state && state.isFocused;\n  return !(showOptionsWhenEmpty && isFocused) && emptyValue;\n}\nvar Typeahead = /*#__PURE__*/function (_Component) {\n  (0, _inherits2[\"default\"])(Typeahead, _Component);\n  var _super = _createSuper(Typeahead);\n  function Typeahead(props) {\n    var _this;\n    (0, _classCallCheck2[\"default\"])(this, Typeahead);\n    _this = _super.call(this, props);\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"root\", /*#__PURE__*/(0, _react.createRef)());\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"entry\", /*#__PURE__*/(0, _react.createRef)());\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"focus\", function () {\n      if (_this.entry.current) {\n        _this.entry.current.focus();\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_hasCustomValue\", function () {\n      return _this.props.allowCustomValues > 0 && _this.state.entryValue.length >= _this.props.allowCustomValues && _this.state.searchResults.indexOf(_this.state.entryValue) < 0;\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_getCustomValue\", function () {\n      return _this._hasCustomValue() ? _this.state.entryValue : null;\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onOptionSelected\", function (option, event) {\n      if (_this.props.searchable) {\n        // reset entry input\n        _this.setState({\n          searchResults: getOptionsForValue('', _this.props, _this.state),\n          selection: '',\n          entryValue: ''\n        });\n      }\n      return _this.props.onOptionSelected(option, event);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onTextEntryUpdated\", function () {\n      if (_this.props.searchable) {\n        var value = _this.entry.current.value;\n        _this.setState({\n          searchResults: getOptionsForValue(value, _this.props, _this.state),\n          selection: '',\n          entryValue: value\n        });\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onEnter\", function (event) {\n      var selection = _this.getSelection();\n      if (!selection) {\n        return _this.props.onKeyDown(event);\n      }\n      return _this._onOptionSelected(selection, event);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onEscape\", function () {\n      _this.setState({\n        selectionIndex: null\n      });\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onTab\", function (event) {\n      var selection = _this.getSelection();\n      var option = selection ? selection : _this.state.searchResults.length > 0 ? _this.state.searchResults[0] : null;\n      if (option === null && _this._hasCustomValue()) {\n        option = _this._getCustomValue();\n      }\n      if (option !== null) {\n        return _this._onOptionSelected(option, event);\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"eventMap\", function (event) {\n      var events = {};\n      events[_keyevent[\"default\"].DOM_VK_UP] = _this.navUp;\n      events[_keyevent[\"default\"].DOM_VK_DOWN] = _this.navDown;\n      events[_keyevent[\"default\"].DOM_VK_RETURN] = events[_keyevent[\"default\"].DOM_VK_ENTER] = _this._onEnter;\n      events[_keyevent[\"default\"].DOM_VK_ESCAPE] = _this._onEscape;\n      events[_keyevent[\"default\"].DOM_VK_TAB] = _this._onTab;\n      return events;\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_nav\", function (delta) {\n      if (!_this._hasHint()) {\n        return;\n      }\n      var newIndex = _this.state.selectionIndex === null ? delta === 1 ? 0 : delta : _this.state.selectionIndex + delta;\n      var length = _this.props.maxVisible ? _this.state.searchResults.slice(0, _this.props.maxVisible).length : _this.state.searchResults.length;\n      if (_this._hasCustomValue()) {\n        length += 1;\n      }\n      if (newIndex < 0) {\n        newIndex += length;\n      } else if (newIndex >= length) {\n        newIndex -= length;\n      }\n      _this.setState({\n        selectionIndex: newIndex\n      });\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"navDown\", function () {\n      _this._nav(1);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"navUp\", function () {\n      _this._nav(-1);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onChange\", function (event) {\n      if (_this.props.onChange) {\n        _this.props.onChange(event);\n      }\n      _this._onTextEntryUpdated();\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onKeyDown\", function (event) {\n      // If there are no visible elements, don't perform selector navigation.\n      // Just pass this up to the upstream onKeydown handler.\n      // Also skip if the user is pressing the shift key, since none of our handlers are looking for shift\n      if (!_this._hasHint() || event.shiftKey) {\n        return _this.props.onKeyDown(event);\n      }\n      var handler = _this.eventMap()[event.keyCode];\n      if (handler) {\n        handler(event);\n      } else {\n        return _this.props.onKeyDown(event);\n      } // Don't propagate the keystroke back to the DOM/browser\n\n      event.preventDefault();\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onFocus\", function (event) {\n      _this.setState({\n        isFocused: true\n      });\n      if (_this.props.onFocus) {\n        return _this.props.onFocus(event);\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onBlur\", function (event) {\n      _this.setState({\n        isFocused: false\n      });\n      if (_this.props.onBlur) {\n        return _this.props.onBlur(event);\n      }\n    });\n    _this.state = {\n      /** @type {ReadonlyArray<string>} */\n      searchResults: [],\n      // This should be called something else, 'entryValue'\n      entryValue: _this.props.value || _this.props.initialValue,\n      // A valid typeahead value\n      selection: _this.props.value,\n      // Index of the selection\n      selectionIndex: null,\n      // Keep track of the focus state of the input element, to determine\n      // whether to show options when empty (if showOptionsWhenEmpty is true)\n      isFocused: false\n    };\n    return _this;\n  }\n  (0, _createClass2[\"default\"])(Typeahead, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // call focus on entry or div to trigger key events listener\n      if (this.entry.current) {\n        this.entry.current.focus();\n      } else {\n        this.root.current.focus();\n      }\n    }\n  }, {\n    key: \"_renderIncrementalSearchResults\",\n    value: function _renderIncrementalSearchResults() {\n      return /*#__PURE__*/_react[\"default\"].createElement(this.props.customListComponent, {\n        fixedOptions: this.props.fixedOptions,\n        options: this.props.maxVisible ? this.state.searchResults.slice(0, this.props.maxVisible) : this.state.searchResults,\n        areResultsTruncated: this.props.maxVisible && this.state.searchResults.length > this.props.maxVisible,\n        resultsTruncatedMessage: this.props.resultsTruncatedMessage,\n        onOptionSelected: this._onOptionSelected,\n        allowCustomValues: this.props.allowCustomValues,\n        customValue: this._getCustomValue(),\n        customClasses: this.props.customClasses,\n        customListItemComponent: this.props.customListItemComponent,\n        customListHeaderComponent: this.props.customListHeaderComponent,\n        selectionIndex: this.state.selectionIndex,\n        defaultClassNames: this.props.defaultClassNames,\n        displayOption: this.props.displayOption,\n        selectedItems: this.props.selectedItems,\n        light: this.props.light\n      });\n    }\n  }, {\n    key: \"getSelection\",\n    value: function getSelection() {\n      var index = this.state.selectionIndex;\n      if (this._hasCustomValue()) {\n        if (index === 0) {\n          return this.state.entryValue;\n        }\n        index--;\n      }\n      if (this._hasFixedOptions()) {\n        return index < this.props.fixedOptions.length ? this.props.fixedOptions[index] : this.state.searchResults[index - this.props.fixedOptions.length];\n      }\n      return this.state.searchResults[index];\n    }\n  }, {\n    key: \"_renderHiddenInput\",\n    value: function _renderHiddenInput() {\n      if (!this.props.name) {\n        return null;\n      }\n      return /*#__PURE__*/_react[\"default\"].createElement(\"input\", {\n        type: \"hidden\",\n        name: this.props.name,\n        value: this.state.selection\n      });\n    }\n  }, {\n    key: \"_hasHint\",\n    value: function _hasHint() {\n      return this.state.searchResults.length > 0 || this._hasCustomValue();\n    }\n  }, {\n    key: \"_hasFixedOptions\",\n    value: function _hasFixedOptions() {\n      return Array.isArray(this.props.fixedOptions) && this.props.fixedOptions.length;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var inputClasses = {};\n      inputClasses[this.props.customClasses.input] = Boolean(this.props.customClasses.input);\n      var inputClassList = (0, _classnames[\"default\"])(inputClasses);\n      var classes = (0, _defineProperty2[\"default\"])({}, DEFAULT_CLASS, this.props.defaultClassNames);\n      classes[this.props.className] = Boolean(this.props.className);\n      var classList = (0, _classnames[\"default\"])(classes);\n      return /*#__PURE__*/_react[\"default\"].createElement(TypeaheadWrapper, {\n        className: classList,\n        ref: this.root,\n        tabIndex: \"0\",\n        onKeyDown: this._onKeyDown,\n        onKeyPress: this.props.onKeyPress,\n        onKeyUp: this.props.onKeyUp,\n        onFocus: this._onFocus,\n        light: this.props.light\n      }, this._renderHiddenInput(), this.props.searchable ? /*#__PURE__*/_react[\"default\"].createElement(InputBox, null, /*#__PURE__*/_react[\"default\"].createElement(TypeaheadInput, (0, _extends2[\"default\"])({\n        ref: this.entry,\n        type: \"text\",\n        disabled: this.props.disabled\n      }, this.props.inputProps, {\n        placeholder: this.props.placeholder,\n        className: inputClassList,\n        value: this.state.entryValue,\n        onChange: this._onChange,\n        onBlur: this._onBlur,\n        light: this.props.light\n      })), /*#__PURE__*/_react[\"default\"].createElement(InputIcon, null, /*#__PURE__*/_react[\"default\"].createElement(this.props.inputIcon, {\n        height: \"18px\"\n      }))) : null, this._renderIncrementalSearchResults());\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      //  invoked after a component is instantiated as well as before it is re-rendered\n      var searchResults = getOptionsForValue(state.entryValue, props, state);\n      return {\n        searchResults: searchResults\n      };\n    }\n  }]);\n  return Typeahead;\n}(_react.Component);\n(0, _defineProperty2[\"default\"])(Typeahead, \"propTypes\", {\n  name: _propTypes[\"default\"].string,\n  customClasses: _propTypes[\"default\"].object,\n  maxVisible: _propTypes[\"default\"].number,\n  resultsTruncatedMessage: _propTypes[\"default\"].string,\n  options: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].any),\n  fixedOptions: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].any),\n  allowCustomValues: _propTypes[\"default\"].number,\n  initialValue: _propTypes[\"default\"].string,\n  value: _propTypes[\"default\"].string,\n  placeholder: _propTypes[\"default\"].string,\n  disabled: _propTypes[\"default\"].bool,\n  textarea: _propTypes[\"default\"].bool,\n  inputProps: _propTypes[\"default\"].object,\n  onOptionSelected: _propTypes[\"default\"].func,\n  onChange: _propTypes[\"default\"].func,\n  onKeyDown: _propTypes[\"default\"].func,\n  onKeyPress: _propTypes[\"default\"].func,\n  onKeyUp: _propTypes[\"default\"].func,\n  onFocus: _propTypes[\"default\"].func,\n  onBlur: _propTypes[\"default\"].func,\n  filterOption: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].string, _propTypes[\"default\"].func]),\n  searchOptions: _propTypes[\"default\"].func,\n  displayOption: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].string, _propTypes[\"default\"].func]),\n  inputDisplayOption: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].string, _propTypes[\"default\"].func]),\n  formInputOption: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].string, _propTypes[\"default\"].func]),\n  defaultClassNames: _propTypes[\"default\"].bool,\n  customListComponent: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].element, _propTypes[\"default\"].func]),\n  customListItemComponent: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].element, _propTypes[\"default\"].func]),\n  customListHeaderComponent: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].element, _propTypes[\"default\"].func]),\n  showOptionsWhenEmpty: _propTypes[\"default\"].bool,\n  searchable: _propTypes[\"default\"].bool\n});\n(0, _defineProperty2[\"default\"])(Typeahead, \"defaultProps\", {\n  options: [],\n  customClasses: {},\n  allowCustomValues: 0,\n  initialValue: '',\n  value: '',\n  placeholder: '',\n  disabled: false,\n  textarea: false,\n  inputProps: {},\n  onOptionSelected: function onOptionSelected(option) {},\n  onChange: function onChange(event) {},\n  onKeyDown: function onKeyDown(event) {},\n  onKeyPress: function onKeyPress(event) {},\n  onKeyUp: function onKeyUp(event) {},\n  onFocus: function onFocus(event) {},\n  onBlur: function onBlur(event) {},\n  filterOption: null,\n  searchOptions: null,\n  inputDisplayOption: null,\n  defaultClassNames: true,\n  customListComponent: _dropdownList[\"default\"],\n  customListItemComponent: _dropdownList.ListItem,\n  inputIcon: _icons.Search,\n  customListHeaderComponent: null,\n  showOptionsWhenEmpty: true,\n  searchable: true,\n  resultsTruncatedMessage: null\n});\n(0, _reactLifecyclesCompat.polyfill)(Typeahead);\nvar _default = Typeahead;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../../src/components/common/item-selector/typeahead.js"],"names":["DEFAULT_CLASS","TypeaheadWrapper","styled","div","props","light","theme","dropdownListBgdLT","dropdownListBgd","dropdownListShadow","InputBox","attrs","className","TypeaheadInput","input","inputLT","secondaryInput","selectBackgroundLT","secondaryInputBgd","InputIcon","inputPlaceholderColor","generateSearchFunction","searchOptions","filterOption","Console","warn","value","options","filter","o","mapper","Accessor","generateAccessor","IDENTITY_FN","extract","map","res","index","getOptionsForValue","state","showOptionsWhenEmpty","searchable","shouldSkipSearch","emptyValue","trim","length","isFocused","Typeahead","Component","name","PropTypes","string","customClasses","object","maxVisible","number","resultsTruncatedMessage","arrayOf","any","fixedOptions","allowCustomValues","initialValue","placeholder","disabled","bool","textarea","inputProps","onOptionSelected","func","onChange","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","oneOfType","displayOption","inputDisplayOption","formInputOption","defaultClassNames","customListComponent","element","customListItemComponent","customListHeaderComponent","option","event","DropdownList","ListItem","inputIcon","Search","searchResults","entryValue","selection","selectionIndex","entry","current","focus","root","indexOf","_hasCustomValue","slice","_onOptionSelected","_getCustomValue","selectedItems","_hasFixedOptions","setState","getSelection","events","KeyEvent","DOM_VK_UP","navUp","DOM_VK_DOWN","navDown","DOM_VK_RETURN","DOM_VK_ENTER","_onEnter","DOM_VK_ESCAPE","_onEscape","DOM_VK_TAB","_onTab","_hasHint","newIndex","delta","_nav","_onTextEntryUpdated","shiftKey","handler","eventMap","keyCode","preventDefault","Array","isArray","inputClasses","Boolean","inputClassList","classes","classList","_onKeyDown","_onFocus","_renderHiddenInput","_onChange","_onBlur","_renderIncrementalSearchResults"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {Component, createRef} from 'react';\nimport {polyfill} from 'react-lifecycles-compat';\nimport PropTypes from 'prop-types';\nimport fuzzy from 'fuzzy';\nimport classNames from 'classnames';\nimport styled from 'styled-components';\nimport {console as Console} from 'global/window';\n\nimport Accessor from './accessor';\nimport DropdownList, {ListItem} from './dropdown-list';\nimport {Search} from 'components/common/icons';\nimport KeyEvent from 'constants/keyevent';\n\nconst DEFAULT_CLASS = 'typeahead';\n/**\n * Copied mostly from 'react-typeahead', an auto-completing text input\n *\n * Renders an text input that shows options nearby that you can use the\n * keyboard or mouse to select.\n */\n\nconst TypeaheadWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  background-color: ${props =>\n    props.light ? props.theme.dropdownListBgdLT : props.theme.dropdownListBgd};\n  box-shadow: ${props => props.theme.dropdownListShadow};\n\n  :focus {\n    outline: 0;\n  }\n`;\n\nconst InputBox = styled.div.attrs({\n  className: 'typeahead__input_box'\n})`\n  padding: 8px;\n`;\n\nconst TypeaheadInput = styled.input`\n  ${props => (props.light ? props.theme.inputLT : props.theme.secondaryInput)} :hover {\n    cursor: pointer;\n    background-color: ${props =>\n      props.light ? props.theme.selectBackgroundLT : props.theme.secondaryInputBgd};\n  }\n`;\n\nconst InputIcon = styled.div.attrs({\n  className: 'typeahead__input_icon'\n})`\n  position: absolute;\n  right: 15px;\n  top: 14px;\n  color: ${props => props.theme.inputPlaceholderColor};\n`;\n\nfunction generateSearchFunction(props) {\n  const {searchOptions, filterOption} = props;\n  if (typeof searchOptions === 'function') {\n    if (filterOption !== null) {\n      Console.warn('searchOptions prop is being used, filterOption prop will be ignored');\n    }\n    return searchOptions;\n  } else if (typeof filterOption === 'function') {\n    // use custom filter option\n    return (value, options) => options.filter(o => filterOption(value, o));\n  }\n\n  const mapper =\n    typeof filterOption === 'string'\n      ? Accessor.generateAccessor(filterOption)\n      : Accessor.IDENTITY_FN;\n\n  return (value, options) =>\n    fuzzy.filter(value, options, {extract: mapper}).map(res => options[res.index]);\n}\n\nfunction getOptionsForValue(value, props, state) {\n  const {options, showOptionsWhenEmpty} = props;\n\n  if (!props.searchable) {\n    // directly pass through options if can not be searched\n    return options;\n  }\n  if (shouldSkipSearch(value, state, showOptionsWhenEmpty)) {\n    return options;\n  }\n\n  const searchOptions = generateSearchFunction(props);\n  return searchOptions(value, options);\n}\n\nfunction shouldSkipSearch(input, state, showOptionsWhenEmpty) {\n  const emptyValue = !input || input.trim().length === 0;\n\n  // this.state must be checked because it may not be defined yet if this function\n  // is called from within getInitialState\n  const isFocused = state && state.isFocused;\n  return !(showOptionsWhenEmpty && isFocused) && emptyValue;\n}\n\nclass Typeahead extends Component {\n  static propTypes = {\n    name: PropTypes.string,\n    customClasses: PropTypes.object,\n    maxVisible: PropTypes.number,\n    resultsTruncatedMessage: PropTypes.string,\n    options: PropTypes.arrayOf(PropTypes.any),\n    fixedOptions: PropTypes.arrayOf(PropTypes.any),\n    allowCustomValues: PropTypes.number,\n    initialValue: PropTypes.string,\n    value: PropTypes.string,\n    placeholder: PropTypes.string,\n    disabled: PropTypes.bool,\n    textarea: PropTypes.bool,\n    inputProps: PropTypes.object,\n    onOptionSelected: PropTypes.func,\n    onChange: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onKeyPress: PropTypes.func,\n    onKeyUp: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    filterOption: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    searchOptions: PropTypes.func,\n    displayOption: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    inputDisplayOption: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    formInputOption: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    defaultClassNames: PropTypes.bool,\n    customListComponent: PropTypes.oneOfType([PropTypes.element, PropTypes.func]),\n    customListItemComponent: PropTypes.oneOfType([PropTypes.element, PropTypes.func]),\n    customListHeaderComponent: PropTypes.oneOfType([PropTypes.element, PropTypes.func]),\n    showOptionsWhenEmpty: PropTypes.bool,\n    searchable: PropTypes.bool\n  };\n\n  static defaultProps = {\n    options: [],\n    customClasses: {},\n    allowCustomValues: 0,\n    initialValue: '',\n    value: '',\n    placeholder: '',\n    disabled: false,\n    textarea: false,\n    inputProps: {},\n    onOptionSelected(option) {},\n    onChange(event) {},\n    onKeyDown(event) {},\n    onKeyPress(event) {},\n    onKeyUp(event) {},\n    onFocus(event) {},\n    onBlur(event) {},\n    filterOption: null,\n    searchOptions: null,\n    inputDisplayOption: null,\n    defaultClassNames: true,\n    customListComponent: DropdownList,\n    customListItemComponent: ListItem,\n    inputIcon: Search,\n    customListHeaderComponent: null,\n    showOptionsWhenEmpty: true,\n    searchable: true,\n    resultsTruncatedMessage: null\n  };\n\n  static getDerivedStateFromProps(props, state) {\n    //  invoked after a component is instantiated as well as before it is re-rendered\n    const searchResults = getOptionsForValue(state.entryValue, props, state);\n\n    return {searchResults};\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      /** @type {ReadonlyArray<string>} */\n      searchResults: [],\n\n      // This should be called something else, 'entryValue'\n      entryValue: this.props.value || this.props.initialValue,\n\n      // A valid typeahead value\n      selection: this.props.value,\n\n      // Index of the selection\n      selectionIndex: null,\n\n      // Keep track of the focus state of the input element, to determine\n      // whether to show options when empty (if showOptionsWhenEmpty is true)\n      isFocused: false\n    };\n  }\n\n  componentDidMount() {\n    // call focus on entry or div to trigger key events listener\n    if (this.entry.current) {\n      this.entry.current.focus();\n    } else {\n      this.root.current.focus();\n    }\n  }\n\n  root = createRef();\n  entry = createRef();\n\n  focus = () => {\n    if (this.entry.current) {\n      this.entry.current.focus();\n    }\n  };\n\n  _hasCustomValue = () => {\n    return (\n      this.props.allowCustomValues > 0 &&\n      this.state.entryValue.length >= this.props.allowCustomValues &&\n      this.state.searchResults.indexOf(this.state.entryValue) < 0\n    );\n  };\n\n  _getCustomValue = () => {\n    return this._hasCustomValue() ? this.state.entryValue : null;\n  };\n\n  _renderIncrementalSearchResults() {\n    return (\n      <this.props.customListComponent\n        fixedOptions={this.props.fixedOptions}\n        options={\n          this.props.maxVisible\n            ? this.state.searchResults.slice(0, this.props.maxVisible)\n            : this.state.searchResults\n        }\n        areResultsTruncated={\n          this.props.maxVisible && this.state.searchResults.length > this.props.maxVisible\n        }\n        resultsTruncatedMessage={this.props.resultsTruncatedMessage}\n        onOptionSelected={this._onOptionSelected}\n        allowCustomValues={this.props.allowCustomValues}\n        customValue={this._getCustomValue()}\n        customClasses={this.props.customClasses}\n        customListItemComponent={this.props.customListItemComponent}\n        customListHeaderComponent={this.props.customListHeaderComponent}\n        selectionIndex={this.state.selectionIndex}\n        defaultClassNames={this.props.defaultClassNames}\n        displayOption={this.props.displayOption}\n        selectedItems={this.props.selectedItems}\n        light={this.props.light}\n      />\n    );\n  }\n\n  getSelection() {\n    let index = this.state.selectionIndex;\n\n    if (this._hasCustomValue()) {\n      if (index === 0) {\n        return this.state.entryValue;\n      }\n      index--;\n    }\n    if (this._hasFixedOptions()) {\n      return index < this.props.fixedOptions.length\n        ? this.props.fixedOptions[index]\n        : this.state.searchResults[index - this.props.fixedOptions.length];\n    }\n    return this.state.searchResults[index];\n  }\n\n  _onOptionSelected = (option, event) => {\n    if (this.props.searchable) {\n      // reset entry input\n      this.setState({\n        searchResults: getOptionsForValue('', this.props, this.state),\n        selection: '',\n        entryValue: ''\n      });\n    }\n\n    return this.props.onOptionSelected(option, event);\n  };\n\n  // use () => {} to avoid binding 'this'\n  _onTextEntryUpdated = () => {\n    if (this.props.searchable) {\n      const value = this.entry.current.value;\n\n      this.setState({\n        searchResults: getOptionsForValue(value, this.props, this.state),\n        selection: '',\n        entryValue: value\n      });\n    }\n  };\n\n  _onEnter = event => {\n    const selection = this.getSelection();\n    if (!selection) {\n      return this.props.onKeyDown(event);\n    }\n    return this._onOptionSelected(selection, event);\n  };\n\n  _onEscape = () => {\n    this.setState({\n      selectionIndex: null\n    });\n  };\n\n  _onTab = event => {\n    const selection = this.getSelection();\n    let option = selection\n      ? selection\n      : this.state.searchResults.length > 0\n      ? this.state.searchResults[0]\n      : null;\n\n    if (option === null && this._hasCustomValue()) {\n      option = this._getCustomValue();\n    }\n\n    if (option !== null) {\n      return this._onOptionSelected(option, event);\n    }\n  };\n\n  eventMap = event => {\n    const events = {};\n\n    events[KeyEvent.DOM_VK_UP] = this.navUp;\n    events[KeyEvent.DOM_VK_DOWN] = this.navDown;\n    events[KeyEvent.DOM_VK_RETURN] = events[KeyEvent.DOM_VK_ENTER] = this._onEnter;\n    events[KeyEvent.DOM_VK_ESCAPE] = this._onEscape;\n    events[KeyEvent.DOM_VK_TAB] = this._onTab;\n\n    return events;\n  };\n\n  _nav = delta => {\n    if (!this._hasHint()) {\n      return;\n    }\n    let newIndex =\n      this.state.selectionIndex === null\n        ? delta === 1\n          ? 0\n          : delta\n        : this.state.selectionIndex + delta;\n    let length = this.props.maxVisible\n      ? this.state.searchResults.slice(0, this.props.maxVisible).length\n      : this.state.searchResults.length;\n    if (this._hasCustomValue()) {\n      length += 1;\n    }\n\n    if (newIndex < 0) {\n      newIndex += length;\n    } else if (newIndex >= length) {\n      newIndex -= length;\n    }\n\n    this.setState({selectionIndex: newIndex});\n  };\n\n  navDown = () => {\n    this._nav(1);\n  };\n\n  navUp = () => {\n    this._nav(-1);\n  };\n\n  _onChange = event => {\n    if (this.props.onChange) {\n      this.props.onChange(event);\n    }\n\n    this._onTextEntryUpdated();\n  };\n\n  _onKeyDown = event => {\n    // If there are no visible elements, don't perform selector navigation.\n    // Just pass this up to the upstream onKeydown handler.\n    // Also skip if the user is pressing the shift key, since none of our handlers are looking for shift\n    if (!this._hasHint() || event.shiftKey) {\n      return this.props.onKeyDown(event);\n    }\n\n    const handler = this.eventMap()[event.keyCode];\n\n    if (handler) {\n      handler(event);\n    } else {\n      return this.props.onKeyDown(event);\n    }\n    // Don't propagate the keystroke back to the DOM/browser\n    event.preventDefault();\n  };\n\n  _onFocus = event => {\n    this.setState({isFocused: true});\n    if (this.props.onFocus) {\n      return this.props.onFocus(event);\n    }\n  };\n\n  _onBlur = event => {\n    this.setState({isFocused: false});\n    if (this.props.onBlur) {\n      return this.props.onBlur(event);\n    }\n  };\n\n  _renderHiddenInput() {\n    if (!this.props.name) {\n      return null;\n    }\n\n    return <input type=\"hidden\" name={this.props.name} value={this.state.selection} />;\n  }\n\n  _hasHint() {\n    return this.state.searchResults.length > 0 || this._hasCustomValue();\n  }\n\n  _hasFixedOptions() {\n    return Array.isArray(this.props.fixedOptions) && this.props.fixedOptions.length;\n  }\n\n  render() {\n    const inputClasses = {};\n    inputClasses[this.props.customClasses.input] = Boolean(this.props.customClasses.input);\n    const inputClassList = classNames(inputClasses);\n\n    const classes = {\n      [DEFAULT_CLASS]: this.props.defaultClassNames\n    };\n    classes[this.props.className] = Boolean(this.props.className);\n    const classList = classNames(classes);\n\n    return (\n      <TypeaheadWrapper\n        className={classList}\n        ref={this.root}\n        tabIndex=\"0\"\n        onKeyDown={this._onKeyDown}\n        onKeyPress={this.props.onKeyPress}\n        onKeyUp={this.props.onKeyUp}\n        onFocus={this._onFocus}\n        light={this.props.light}\n      >\n        {this._renderHiddenInput()}\n        {this.props.searchable ? (\n          <InputBox>\n            <TypeaheadInput\n              ref={this.entry}\n              type=\"text\"\n              disabled={this.props.disabled}\n              {...this.props.inputProps}\n              placeholder={this.props.placeholder}\n              className={inputClassList}\n              value={this.state.entryValue}\n              onChange={this._onChange}\n              onBlur={this._onBlur}\n              light={this.props.light}\n            />\n            <InputIcon>\n              <this.props.inputIcon height=\"18px\" />\n            </InputIcon>\n          </InputBox>\n        ) : null}\n        {this._renderIncrementalSearchResults()}\n      </TypeaheadWrapper>\n    );\n  }\n}\n\npolyfill(Typeahead);\n\nexport default Typeahead;\n"]},"metadata":{},"sourceType":"script"}