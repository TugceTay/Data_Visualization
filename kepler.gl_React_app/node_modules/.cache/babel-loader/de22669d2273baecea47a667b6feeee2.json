{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = MapPopoverFactory;\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _layerHoverInfo = _interopRequireDefault(require(\"./layer-hover-info\"));\nvar _coordinateInfo = _interopRequireDefault(require(\"./coordinate-info\"));\nvar _icons = require(\"../common/icons\");\nvar _reactIntl = require(\"react-intl\");\nvar _localization = require(\"../../localization\");\nvar _headless = _interopRequireDefault(require(\"@tippyjs/react/headless\"));\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\nvar MAX_WIDTH = 500;\nvar MAX_HEIGHT = 600;\nvar StyledMapPopover = _styledComponents[\"default\"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  flex-direction: column;\\n  max-width: \", \"px;\\n  max-height: \", \"px;\\n  padding: 14px;\\n  & > * + * {\\n    margin-top: 6px;\\n  }\\n  \", \";\\n  font-family: \", \";\\n  font-size: 11px;\\n  font-weight: 500;\\n  background-color: \", \";\\n  color: \", \";\\n  z-index: 1000;\\n  overflow-x: auto;\\n  box-shadow: \", \";\\n\\n  :hover {\\n    background-color: \", \";\\n  }\\n\\n  .primary-label {\\n    color: \", \";\\n    font-size: 10px;\\n  }\\n\\n  .map-popover__layer-info,\\n  .coordingate-hover-info {\\n    & > * + * {\\n      margin-top: 7px;\\n    }\\n  }\\n\\n  table {\\n    width: auto;\\n    display: grid;\\n    border-collapse: collapse;\\n    row-gap: 5px;\\n    column-gap: 5px;\\n  }\\n\\n  .coordingate-hover-info > table {\\n    grid-template-columns: auto auto auto;\\n  }\\n  .map-popover__layer-info > table {\\n    grid-template-columns: auto auto;\\n  }\\n\\n  tbody,\\n  tr {\\n    display: contents;\\n  }\\n\\n  td {\\n    border-color: transparent;\\n    color: \", \";\\n  }\\n\\n  td.row__value {\\n    text-align: right;\\n    font-weight: 500;\\n    color: \", \";\\n  }\\n\"])), MAX_WIDTH, MAX_HEIGHT, function (props) {\n  return props.theme.scrollBar;\n}, function (props) {\n  return props.theme.fontFamily;\n}, function (props) {\n  return props.theme.panelBackground;\n}, function (props) {\n  return props.theme.textColor;\n}, function (props) {\n  return props.theme.panelBoxShadow;\n}, function (props) {\n  return \"\".concat(props.theme.panelBackground, \"dd\");\n}, function (props) {\n  return props.theme.notificationColors.success;\n}, function (props) {\n  return props.theme.textColor;\n}, function (props) {\n  return props.theme.textColorHl;\n});\nvar PinnedButtons = _styledComponents[\"default\"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  align-self: center;\\n  align-items: center;\\n  justify-items: center;\\n  & > * + * {\\n    margin-left: 10px;\\n  }\\n\"])));\nvar PopoverContent = _styledComponents[\"default\"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  flex-direction: column;\\n  & > * + * {\\n    margin-top: 12px;\\n  }\\n\"])));\nvar StyledIcon = _styledComponents[\"default\"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  color: \", \";\\n\\n  &.popover-pin {\\n    transform: rotate(30deg);\\n  }\\n\\n  :hover {\\n    cursor: pointer;\\n    color: \", \";\\n  }\\n\"])), function (props) {\n  return props.theme.activeColor;\n}, function (props) {\n  return props.theme.linkBtnColor;\n});\nMapPopoverFactory.deps = [_layerHoverInfo[\"default\"], _coordinateInfo[\"default\"]];\nfunction createVirtualReference(container, x, y) {\n  var size = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n  var bounds = container && container.getBoundingClientRect ? container.getBoundingClientRect() : {};\n  var left = (bounds.left || 0) + x - size / 2;\n  var top = (bounds.top || 0) + y - size / 2;\n  return {\n    left: left,\n    top: top,\n    right: left + size,\n    bottom: top + size,\n    width: size,\n    height: size\n  };\n}\nfunction getOffsetForPlacement(_ref) {\n  var placement = _ref.placement,\n    reference = _ref.reference,\n    popper = _ref.popper;\n  var gap = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;\n  switch (placement) {\n    case 'top-start':\n    case 'bottom-start':\n      return [gap, gap];\n    case 'top-end':\n    case 'bottom-end':\n      return [-gap, gap];\n    default:\n      return [0, 0];\n  }\n}\nfunction getPopperOptions(container) {\n  return {\n    modifiers: [{\n      name: 'preventOverflow',\n      options: {\n        boundary: container\n      }\n    }]\n  };\n}\nfunction MapPopoverFactory(LayerHoverInfo, CoordinateInfo) {\n  /** @type {typeof import('./map-popover').MapPopover} */\n  var MapPopover = function MapPopover(_ref2) {\n    var x = _ref2.x,\n      y = _ref2.y,\n      frozen = _ref2.frozen,\n      coordinate = _ref2.coordinate,\n      layerHoverProp = _ref2.layerHoverProp,\n      isBase = _ref2.isBase,\n      zoom = _ref2.zoom,\n      container = _ref2.container,\n      onClose = _ref2.onClose;\n    var _useState = (0, _react.useState)('start'),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      horizontalPlacement = _useState2[0],\n      setHorizontalPlacement = _useState2[1];\n    var moveLeft = function moveLeft() {\n      return setHorizontalPlacement('end');\n    };\n    var moveRight = function moveRight() {\n      return setHorizontalPlacement('start');\n    };\n    return /*#__PURE__*/_react[\"default\"].createElement(_headless[\"default\"], {\n      popperOptions: getPopperOptions(container),\n      zIndex: 999\n      /* should be below Modal which has zIndex=1000 */,\n\n      visible: true,\n      interactive: true,\n      getReferenceClientRect: function getReferenceClientRect() {\n        return createVirtualReference(container, x, y);\n      } // @ts-ignore\n      ,\n\n      placement: \"bottom-\".concat(horizontalPlacement) // @ts-ignore\n      ,\n\n      offset: getOffsetForPlacement,\n      appendTo: document.body,\n      render: function render(attrs) {\n        return /*#__PURE__*/_react[\"default\"].createElement(StyledMapPopover, (0, _extends2[\"default\"])({}, attrs, {\n          className: \"map-popover\"\n        }), frozen ? /*#__PURE__*/_react[\"default\"].createElement(PinnedButtons, null, horizontalPlacement === 'start' && /*#__PURE__*/_react[\"default\"].createElement(StyledIcon, {\n          className: \"popover-arrow-left\",\n          onClick: moveLeft\n        }, /*#__PURE__*/_react[\"default\"].createElement(_icons.ArrowLeft, null)), /*#__PURE__*/_react[\"default\"].createElement(StyledIcon, {\n          className: \"popover-pin\",\n          onClick: onClose\n        }, /*#__PURE__*/_react[\"default\"].createElement(_icons.Pin, {\n          height: \"16px\"\n        })), horizontalPlacement === 'end' && /*#__PURE__*/_react[\"default\"].createElement(StyledIcon, {\n          className: \"popover-arrow-right\",\n          onClick: moveRight\n        }, /*#__PURE__*/_react[\"default\"].createElement(_icons.ArrowRight, null)), isBase && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"primary-label\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_localization.FormattedMessage, {\n          id: \"mapPopover.primary\"\n        }))) : null, /*#__PURE__*/_react[\"default\"].createElement(PopoverContent, null, Array.isArray(coordinate) && /*#__PURE__*/_react[\"default\"].createElement(CoordinateInfo, {\n          coordinate: coordinate,\n          zoom: zoom\n        }), layerHoverProp && /*#__PURE__*/_react[\"default\"].createElement(LayerHoverInfo, layerHoverProp)));\n      }\n    });\n  };\n  return (0, _reactIntl.injectIntl)(MapPopover);\n}","map":{"version":3,"sources":["../../../src/components/map/map-popover.js"],"names":["MAX_WIDTH","MAX_HEIGHT","StyledMapPopover","styled","div","props","theme","scrollBar","fontFamily","panelBackground","textColor","panelBoxShadow","notificationColors","success","textColorHl","PinnedButtons","PopoverContent","StyledIcon","activeColor","linkBtnColor","MapPopoverFactory","deps","LayerHoverInfoFactory","CoordinateInfoFactory","createVirtualReference","container","x","y","size","bounds","getBoundingClientRect","left","top","right","bottom","width","height","getOffsetForPlacement","placement","reference","popper","gap","getPopperOptions","modifiers","name","options","boundary","LayerHoverInfo","CoordinateInfo","MapPopover","frozen","coordinate","layerHoverProp","isBase","zoom","onClose","horizontalPlacement","setHorizontalPlacement","moveLeft","moveRight","document","body","attrs","Array","isArray"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {useState} from 'react';\nimport styled from 'styled-components';\nimport LayerHoverInfoFactory from './layer-hover-info';\nimport CoordinateInfoFactory from './coordinate-info';\nimport {ArrowLeft, ArrowRight, Pin} from 'components/common/icons';\nimport {injectIntl} from 'react-intl';\nimport {FormattedMessage} from 'localization';\nimport Tippy from '@tippyjs/react/headless';\n\nconst MAX_WIDTH = 500;\nconst MAX_HEIGHT = 600;\n\nconst StyledMapPopover = styled.div`\n  display: flex;\n  flex-direction: column;\n  max-width: ${MAX_WIDTH}px;\n  max-height: ${MAX_HEIGHT}px;\n  padding: 14px;\n  & > * + * {\n    margin-top: 6px;\n  }\n  ${props => props.theme.scrollBar};\n  font-family: ${props => props.theme.fontFamily};\n  font-size: 11px;\n  font-weight: 500;\n  background-color: ${props => props.theme.panelBackground};\n  color: ${props => props.theme.textColor};\n  z-index: 1000;\n  overflow-x: auto;\n  box-shadow: ${props => props.theme.panelBoxShadow};\n\n  :hover {\n    background-color: ${props => `${props.theme.panelBackground}dd`};\n  }\n\n  .primary-label {\n    color: ${props => props.theme.notificationColors.success};\n    font-size: 10px;\n  }\n\n  .map-popover__layer-info,\n  .coordingate-hover-info {\n    & > * + * {\n      margin-top: 7px;\n    }\n  }\n\n  table {\n    width: auto;\n    display: grid;\n    border-collapse: collapse;\n    row-gap: 5px;\n    column-gap: 5px;\n  }\n\n  .coordingate-hover-info > table {\n    grid-template-columns: auto auto auto;\n  }\n  .map-popover__layer-info > table {\n    grid-template-columns: auto auto;\n  }\n\n  tbody,\n  tr {\n    display: contents;\n  }\n\n  td {\n    border-color: transparent;\n    color: ${props => props.theme.textColor};\n  }\n\n  td.row__value {\n    text-align: right;\n    font-weight: 500;\n    color: ${props => props.theme.textColorHl};\n  }\n`;\n\nconst PinnedButtons = styled.div`\n  display: flex;\n  align-self: center;\n  align-items: center;\n  justify-items: center;\n  & > * + * {\n    margin-left: 10px;\n  }\n`;\n\nconst PopoverContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  & > * + * {\n    margin-top: 12px;\n  }\n`;\n\nconst StyledIcon = styled.div`\n  color: ${props => props.theme.activeColor};\n\n  &.popover-pin {\n    transform: rotate(30deg);\n  }\n\n  :hover {\n    cursor: pointer;\n    color: ${props => props.theme.linkBtnColor};\n  }\n`;\n\nMapPopoverFactory.deps = [LayerHoverInfoFactory, CoordinateInfoFactory];\n\nfunction createVirtualReference(container, x, y, size = 0) {\n  const bounds =\n    container && container.getBoundingClientRect ? container.getBoundingClientRect() : {};\n  const left = (bounds.left || 0) + x - size / 2;\n  const top = (bounds.top || 0) + y - size / 2;\n  return {\n    left,\n    top,\n    right: left + size,\n    bottom: top + size,\n    width: size,\n    height: size\n  };\n}\n\nfunction getOffsetForPlacement({placement, reference, popper}, gap = 20) {\n  switch (placement) {\n    case 'top-start':\n    case 'bottom-start':\n      return [gap, gap];\n    case 'top-end':\n    case 'bottom-end':\n      return [-gap, gap];\n    default:\n      return [0, 0];\n  }\n}\n\nfunction getPopperOptions(container) {\n  return {\n    modifiers: [\n      {\n        name: 'preventOverflow',\n        options: {\n          boundary: container\n        }\n      }\n    ]\n  };\n}\n\nexport default function MapPopoverFactory(LayerHoverInfo, CoordinateInfo) {\n  /** @type {typeof import('./map-popover').MapPopover} */\n  const MapPopover = ({\n    x,\n    y,\n    frozen,\n    coordinate,\n    layerHoverProp,\n    isBase,\n    zoom,\n    container,\n    onClose\n  }) => {\n    const [horizontalPlacement, setHorizontalPlacement] = useState('start');\n    const moveLeft = () => setHorizontalPlacement('end');\n    const moveRight = () => setHorizontalPlacement('start');\n    return (\n      <Tippy\n        popperOptions={getPopperOptions(container)}\n        zIndex={999} /* should be below Modal which has zIndex=1000 */\n        visible={true}\n        interactive={true}\n        getReferenceClientRect={() => createVirtualReference(container, x, y)}\n        // @ts-ignore\n        placement={`bottom-${horizontalPlacement}`}\n        // @ts-ignore\n        offset={getOffsetForPlacement}\n        appendTo={document.body}\n        render={attrs => (\n          <StyledMapPopover {...attrs} className=\"map-popover\">\n            {frozen ? (\n              <PinnedButtons>\n                {horizontalPlacement === 'start' && (\n                  <StyledIcon className=\"popover-arrow-left\" onClick={moveLeft}>\n                    <ArrowLeft />\n                  </StyledIcon>\n                )}\n                <StyledIcon className=\"popover-pin\" onClick={onClose}>\n                  <Pin height=\"16px\" />\n                </StyledIcon>\n                {horizontalPlacement === 'end' && (\n                  <StyledIcon className=\"popover-arrow-right\" onClick={moveRight}>\n                    <ArrowRight />\n                  </StyledIcon>\n                )}\n                {isBase && (\n                  <div className=\"primary-label\">\n                    <FormattedMessage id=\"mapPopover.primary\" />\n                  </div>\n                )}\n              </PinnedButtons>\n            ) : null}\n            <PopoverContent>\n              {Array.isArray(coordinate) && <CoordinateInfo coordinate={coordinate} zoom={zoom} />}\n              {layerHoverProp && <LayerHoverInfo {...layerHoverProp} />}\n            </PopoverContent>\n          </StyledMapPopover>\n        )}\n      />\n    );\n  };\n  return injectIntl(MapPopover);\n}\n"]},"metadata":{},"sourceType":"script"}