{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nvar STATUS = {\n  REQUESTED: 'REQUESTED',\n  COMPLETED: 'COMPLETED',\n  ERROR: 'ERROR'\n};\nvar I3STileManager = function () {\n  function I3STileManager() {\n    _classCallCheck(this, I3STileManager);\n    this._statusMap = {};\n  }\n  _createClass(I3STileManager, [{\n    key: \"add\",\n    value: function add(request, key, callback, frameState) {\n      var _this = this;\n      if (!this._statusMap[key]) {\n        this._statusMap[key] = {\n          request: request,\n          callback: callback,\n          key: key,\n          frameState: frameState,\n          status: STATUS.REQUESTED\n        };\n        request().then(function (data) {\n          _this._statusMap[key].status = STATUS.COMPLETED;\n          _this._statusMap[key].callback(data, frameState);\n        })[\"catch\"](function (error) {\n          _this._statusMap[key].status = STATUS.ERROR;\n          callback(error);\n        });\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(key, frameState) {\n      if (this._statusMap[key]) {\n        this._statusMap[key].frameState = frameState;\n      }\n    }\n  }, {\n    key: \"find\",\n    value: function find(key) {\n      return this._statusMap[key];\n    }\n  }]);\n  return I3STileManager;\n}();\nexport { I3STileManager as default };","map":{"version":3,"sources":["../../../../src/tileset/traversers/i3s-tile-manager.js"],"names":["STATUS","REQUESTED","COMPLETED","ERROR","I3STileManager","_statusMap","request","key","callback","frameState","status","then","data","error"],"mappings":";;AAAA,IAAMA,MAAM,GAAG;EACbC,SAAS,EAAE,WADE;EAEbC,SAAS,EAAE,WAFE;EAGbC,KAAK,EAAE;AAHM,CAAf;IAOqBC,c;EACnB,SAAA,cAAA,GAAc;IAAA,eAAA,CAAA,IAAA,EAAA,cAAA,CAAA;IACZ,IAAA,CAAKC,UAAL,GAAkB,CAAA,CAAlB;EACD;;;wBAEGC,O,EAASC,G,EAAKC,Q,EAAUC,U,EAAY;MAAA,IAAA,KAAA,GAAA,IAAA;MACtC,IAAI,CAAC,IAAA,CAAKJ,UAAL,CAAgBE,GAAhB,CAAL,EAA2B;QACzB,IAAA,CAAKF,UAAL,CAAgBE,GAAhB,CAAA,GAAuB;UAACD,OAAO,EAAPA,OAAD;UAAUE,QAAQ,EAARA,QAAV;UAAoBD,GAAG,EAAHA,GAApB;UAAyBE,UAAU,EAAVA,UAAzB;UAAqCC,MAAM,EAAEV,MAAM,CAACC;QAApD,CAAvB;QACAK,OAAO,EAAA,CACJK,IADHL,CACQ,UAAA,IAAI,EAAI;UACZ,KAAI,CAACD,UAAL,CAAgBE,GAAhB,CAAA,CAAqBG,MAArB,GAA8BV,MAAM,CAACE,SAArC;UACA,KAAI,CAACG,UAAL,CAAgBE,GAAhB,CAAA,CAAqBC,QAArB,CAA8BI,IAA9B,EAAoCH,UAApC,CAAA;QACD,CAJHH,CAAAA,CAAAA,OAAAA,CAAAA,CAKS,UAAA,KAAK,EAAI;UACd,KAAI,CAACD,UAAL,CAAgBE,GAAhB,CAAA,CAAqBG,MAArB,GAA8BV,MAAM,CAACG,KAArC;UACAK,QAAQ,CAACK,KAAD,CAARL;QACD,CARHF,CAAAA;MASD;IACF;;;2BAEMC,G,EAAKE,U,EAAY;MACtB,IAAI,IAAA,CAAKJ,UAAL,CAAgBE,GAAhB,CAAJ,EAA0B;QACxB,IAAA,CAAKF,UAAL,CAAgBE,GAAhB,CAAA,CAAqBE,UAArB,GAAkCA,UAAlC;MACD;IACF;;;yBAEIF,G,EAAK;MACR,OAAO,IAAA,CAAKF,UAAL,CAAgBE,GAAhB,CAAP;IACD;;;;SA5BkBH,c","sourcesContent":["const STATUS = {\n  REQUESTED: 'REQUESTED',\n  COMPLETED: 'COMPLETED',\n  ERROR: 'ERROR'\n};\n\n// A helper class to manage tile metadata fetching\nexport default class I3STileManager {\n  constructor() {\n    this._statusMap = {};\n  }\n\n  add(request, key, callback, frameState) {\n    if (!this._statusMap[key]) {\n      this._statusMap[key] = {request, callback, key, frameState, status: STATUS.REQUESTED};\n      request()\n        .then(data => {\n          this._statusMap[key].status = STATUS.COMPLETED;\n          this._statusMap[key].callback(data, frameState);\n        })\n        .catch(error => {\n          this._statusMap[key].status = STATUS.ERROR;\n          callback(error);\n        });\n    }\n  }\n\n  update(key, frameState) {\n    if (this._statusMap[key]) {\n      this._statusMap[key].frameState = frameState;\n    }\n  }\n\n  find(key) {\n    return this._statusMap[key];\n  }\n}\n"]},"metadata":{},"sourceType":"module"}